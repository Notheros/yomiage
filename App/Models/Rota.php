<?phpclass Rota {    private $conn;    private $idRota;    private $rota;    private $caminho;    function __construct() {        $this->conn = CONNECTION::getInstance();    }    function loadView() {        $query = "SELECT R.conteudo, T.conteudo AS template "                . "FROM tb_rota R INNER JOIN tb_template T ON R.fk_template = T.id_template "                . "WHERE url =  '{$this->getRota()}'";        $this->conn->executeQuery($query);        $rota = $this->conn->getArrayFromResult();        return !empty($rota) ? $rota[0] : false;    }    function userHasPermission() {        $query = "SELECT * "                . "FROM tb_usuario U "                . "INNER JOIN con_privilegio P ON P.fk_usuario = U.id_usuario "                . "INNER JOIN tb_rota R ON P.fk_rota = R.id_rota "                . "WHERE R.url = '{$this->getRota()}' AND U.id_usuario = '{$_SESSION['USER']['ID_USUARIO']}'";        $this->conn->executeQuery($query);        $permission = $this->conn->getArrayFromResult();        return !empty($permission) ? $this->loadView() : false;    }    function getRotasPublicas() {        $query = "SELECT url FROM tb_rota WHERE publica = 1 AND status = 1";        $this->conn->executeQuery($query);        $rotas = $this->conn->getUniqueSingleArray();        return array_values($rotas);    }    function isValid($request) {        $query = "SELECT url FROM tb_rota WHERE url = '{$request}' AND status = 1";        $this->conn->executeQuery($query);        $rotas = $this->conn->getUniqueSingleArray();        return empty($rotas) ? false : true;    }    function hasPermission($id_rota) {        $query = "SELECT * FROM con_privilegio "                . "INNER JOIN tb_rota ON id_rota = fk_rota AND tb_rota.status = 1 "                . "WHERE fk_rota = '{$id_rota}' AND fk_usuario = '{$_SESSION['USER']['ID_USUARIO']}'";        $this->conn->executeQuery($query);        $permission = $this->conn->getArrayFromResult();        return !empty($permission) ? true : false;    }    function getIdRota() {        return $this->idRota;    }    function getRota() {        return $this->rota;    }    function getCaminho() {        return $this->caminho;    }    function setIdRota($idRota) {        $this->idRota = $idRota;    }    function setRota($rota) {        $this->rota = $rota;    }    function setCaminho($caminho) {        $this->caminho = $caminho;    }}